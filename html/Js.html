<script
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
  integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
  crossorigin="anonymous"
></script>
<script>
  // Prevent forms from submitting.
  function preventFormSubmit() {
    var forms = document.querySelectorAll('form');
    for (var i = 0; i < forms.length; i++) {
      forms[i].addEventListener('submit', function (event) {
        event.preventDefault();
      });
    }
  }
  window.addEventListener('load', preventFormSubmit);
  function onSuccess(result) {
    google.script.host.close();
  }
  function onFailure(e) {
    alert(e.message + '\n\n' + e.stack);
  }
  function handleFormSubmit(formObject, mode) {
    switch (mode) {
      case 'init':
        google.script.run
          .withSuccessHandler(onSuccess)
          .withFailureHandler(onFailure)
          .init(formObject);
        break;
      case 'run':
        google.script.run
          .withSuccessHandler(onSuccess)
          .withFailureHandler(onFailure)
          .run(formObject);
        break;
      default:
        alert('Unknown mode: ' + mode);
    }
  }
</script>
